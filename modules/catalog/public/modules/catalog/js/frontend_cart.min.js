var cart_items=[],subtotal_save="",_process_cart=function(a){subtotal_save=$("#taracot_catalog_cart_subtotal").html(),$("#taracot_catalog_cart_subtotal").html('<img src="/modules/catalog/images/loading_16x16.gif" alt="" width="16" height="16">'),$("#taracot_catalog_cart_error").hide(),$(".taracot-catalog-cart-input-amount").removeClass("uk-form-danger"),$("#taracot_catalog_cart_btn_recalc").attr("disabled",!0),$(".taracot-cart-item-del").attr("disabled",!0),$.ajax({type:"POST",url:"/catalog/ajax/cart",dataType:"json",data:{values:a},success:function(a){if($("#taracot_catalog_cart_btn_recalc").attr("disabled",!1),$(".taracot-cart-item-del").attr("disabled",!1),1==a.status){if($("#taracot_catalog_cart_subtotal").html(a.subtotal?a.subtotal:subtotal_save),a.cart&&a.cart.length)for(var b=0;b<a.cart.length;b++)$("#cart_sum_"+a.cart[b].id).html(a.cart[b].sum),$("#cart_amount_"+a.cart[b].id).val(a.cart[b].amount),"0"==a.cart[b].amount&&$("#cart_sum_"+a.cart[b].id).parent().parent().remove();parseInt(a.cart_size)<1&&($("#taracot_catalog_cart_wrap").hide(),$("#taracot_catalog_cart_empty").show())}else $("#taracot_catalog_cart_subtotal").html(subtotal_save),$("#taracot_catalog_cart_error").html(_lang_vars.ajax_failed),$("#taracot_catalog_cart_error").show()},error:function(){$("#taracot_catalog_cart_btn_recalc").attr("disabled",!1),$(".taracot-cart-item-del").attr("disabled",!1),$("#taracot_catalog_cart_subtotal").html(subtotal_save),$("#taracot_catalog_cart_error").html(_lang_vars.ajax_failed),$("#taracot_catalog_cart_error").show()}})};$(document).ready(function(){$("#taracot_catalog_cart_wrap").show(),$("#taracot_catalog_cart_empty").hide(),init_cart.length&&0!==whitems_length||($("#taracot_catalog_cart_empty").show(),$("#taracot_catalog_cart_wrap").hide());for(var a=0;a<init_cart.length;a++)$("#cart_amount_"+init_cart[a].sku).val(init_cart[a].amount);$(".taracot-catalog-cart-input-amount").each(function(){var a=$(this).attr("id").replace(/^cart_amount_/,"");cart_items.push(a)}),$("#taracot_catalog_cart_btn_recalc").click(function(){for(var a=[],b=0;b<cart_items.length;b++){var c=$.trim($("#cart_amount_"+cart_items[b]).val());if($("#cart_amount_"+cart_items[b]).is(":visible")&&(""===c||isNaN(parseInt(c))||parseInt(c)<0||parseInt(c)>999))return $("#cart_amount_"+cart_items[b]).addClass("uk-form-danger"),$("#cart_amount_"+cart_items[b]).focus(),$("#taracot_catalog_cart_error").html(_lang_vars.form_errors),void $("#taracot_catalog_cart_error").show();$("#cart_amount_"+cart_items[b]).is(":visible")&&a.push({id:cart_items[b],val:c})}_process_cart(a)}),$(".taracot-cart-item-del").click(function(){for(var a=[],b=0;b<cart_items.length;b++){var c=$.trim($("#cart_amount_"+cart_items[b]).val())||"0";if(cart_items[b]==$(this).attr("id").replace(/^cart_del_/,"")&&(c="0"),""===c||isNaN(parseInt(c))||parseInt(c)<0||parseInt(c)>999)return $("#cart_amount_"+cart_items[b]).addClass("uk-form-danger"),$("#cart_amount_"+cart_items[b]).focus(),$("#taracot_catalog_cart_error").html(_lang_vars.form_errors),void $("#taracot_catalog_cart_error").show();a.push({id:cart_items[b],val:c})}_process_cart(a)}),$(".taracot-catalog-cart-btn-back").click(function(){var a=_taracot_catalog_init_path||"/";location.href="/catalog"+a+"?find="+(_taracot_catalog_init_find||"")+"&sort="+(_taracot_catalog_init_sort||"t")+"&show_all="+(_taracot_catalog_init_view||1)+"&page="+(_taracot_catalog_init_page||1)+"&rnd="+parseInt(9e5*Math.random()+1e3)}),$(".taracot-catalog-cart-btn-checkout").click(function(){location.href="/catalog/checkout?cat="+(_taracot_catalog_init_path||"/")+"&find="+(_taracot_catalog_init_find||"")+"&sort="+(_taracot_catalog_init_sort||"t")+"&show_all="+(_taracot_catalog_init_view||1)+"&page="+(_taracot_catalog_init_page||1)+"&rnd="+parseInt(9e5*Math.random()+1e3)})});