!function(a){function b(){document.getElementById("_taracot_loader_image").style.backgroundImage="url("+l+")",document.getElementById("_taracot_loader_image").style.width=h+"px",document.getElementById("_taracot_loader_image").style.height=i+"px",FPS=Math.round(100/g),q=1/FPS,p=setTimeout(c,q/1e3)}function c(){o+=k,n+=1,n>=j&&(o=0,n=0),document.getElementById("_taracot_loader_image")&&(document.getElementById("_taracot_loader_image").style.backgroundPosition=-o+"px 0"),p=setTimeout(c,1e3*q)}function d(a,b){clearTimeout(m),m=0,genImage=new Image,genImage.onload=function(){m=setTimeout(b,0)},genImage.src=a}var e,f=jQuery.extend({},f),g=9,h=100,i=100,j=12,k=100,l="/images/loading.png",m=!1,n=0,o=0,p=!1,q=0,r={init:function(){a("body").append('<div id="_taracot-loading-modal" class="uk-modal"><div class="uk-modal-dialog uk-modal-dialog-frameless" style="background:0;box-shadow:0 0 0px rgba(0,0,0,0);position:absolute;top:50%;left:50%;margin-top:-50px;margin-left:-50px;width:100px;height:100px;"><div id="_taracot_loader_image"></div></div></div>'),e=a.UIkit.modal("#_taracot-loading-modal",{bgclose:!1,keyboard:!1}),new d(l,b)},show:function(){a("#_taracot-loading-modal").show(),e.show()},hide:function(){e.hide(),a("#_taracot-loading-modal").hide()}};a.loadingIndicator=function(b){return r[b]?r[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Method "+b+" doesn't exists"):r.init.apply(this,arguments)}}(jQuery);var comment_parent="";$("#taracot_comment_form").is(":visible")||$(".taracot-comment-reply-link").hide(),$.loadingIndicator(),$("#btn_post_comment").click(function(){var a=$("#post_comment_text").val().replace(/(?:(?:^|\n)\s+|\s+(?:$|\n))/g,"").replace(/\s+/g," ");return $("#post_comment_text").removeClass("uk-form-danger"),$(".taracot-post-comment-error").html(""),!a||a.length<2||a.length>2048?$("#post_comment_text").addClass("uk-form-danger"):($("#btn_post_comment").hide(),$("#btn_post_comment_loading").show(),void $.ajax({type:"POST",url:"/blog/post/comment",dataType:"json",data:{post_id:post_id,comment_parent:comment_parent,comment_text:a},success:function(a){if($("#btn_post_comment").show(),$("#btn_post_comment_loading").hide(),1==a.status){if($("#post_comment_text").val(""),comment_parent&&$("#comment_"+comment_parent).show(),$("#taracot_comment_form_wrap").show(),$("#taracot_comment_form").detach().appendTo($("#taracot_comment_form_wrap")),$("#comment_new").hide(),a.comment_html&&a.comment_id){if(comment_parent){var b="",c=!1;if($("#taracot_comments_flow > .taracot-comment").each(function(){if(!c){var d=$(this).attr("id").replace("taracot_comment_","");if(d==comment_parent)return b=$(this).css("margin-left");if($(this).css("margin-left")<=b){var e=parseInt(b.replace("px",""))+15;a.comment_html=a.comment_html.replace(/\[set_margin\]/,e),$(this).before(a.comment_html),c=!0}}}),!c){var d=parseInt(b.replace("px",""))+15;a.comment_html=a.comment_html.replace(/\[set_margin\]/,d),$("#taracot_comments_flow").append(a.comment_html)}}else $("#taracot_comments_flow").append(a.comment_html);$("html,body").animate({scrollTop:$("#taracot_comment_"+a.comment_id).offset().top-50},200,function(){$("#taracot_comment_"+a.comment_id).animate({opacity:0},100,function(){$("#taracot_comment_"+a.comment_id).animate({opacity:1},300)})}),$("#btn_post_comment").hover(),$("#post_comment_text").hover()}comment_parent="",$(".taracot-comment-reply-link").unbind(),$(".taracot-comment-reply-link").click(taracot_comment_reply_link_handler)}else{var e=_lang_vars.ajax_failed;a.error&&(e=a.error),$(".taracot-post-comment-error").html(e),$("#post_comment_text").focus()}},error:function(){$("#btn_post_comment").show(),$("#btn_post_comment_loading").hide(),$(".taracot-post-comment-error").html(_lang_vars.ajax_failed),$("#post_comment_text").focus()}}))});var taracot_comment_reply_link_handler=function(){var a=$(this).attr("id").replace("comment_","");$("#taracot_comment_form").detach().appendTo($("#comment_"+a).parent()),comment_parent&&$("#comment_"+comment_parent).show(),$("#comment_"+a).hide(),comment_parent=a,$("#post_comment_text").removeClass("uk-form-danger"),$("#post_comment_text").val(""),$("#post_comment_text").focus(),$("#comment_new").show(),$("#taracot_comment_form_wrap").hide()};$(".taracot-comment-new-link").click(function(){comment_parent&&$("#comment_"+comment_parent).show(),$("#taracot_comment_form_wrap").show(),$("#taracot_comment_form").detach().appendTo($("#taracot_comment_form_wrap")),$("#comment_new").hide(),comment_parent=""});var taracot_comment_delete_handler=function(){if(confirm(_lang_vars.comment_delete_confirm)){var a=$(this).attr("id").replace("comment_delete_","");$.loadingIndicator("show"),$.ajax({type:"POST",url:"/blog/post/comment/delete",dataType:"json",data:{comment_id:a},success:function(b){if($.loadingIndicator("hide"),1==b.status)$("#taracot_comment_"+a).html(_lang_vars.comment_deleted),$("#taracot_comment_"+a).addClass("taracot-comment-deleted");else{if(b.error)return alert(b.error);alert(_lang_vars.ajax_failed)}},error:function(){$.loadingIndicator("hide"),alert(_lang_vars.ajax_failed)}})}};$(".taracot-comment-reply-link").click(taracot_comment_reply_link_handler),$(".taracot-comment-delete").click(taracot_comment_delete_handler),$("#post_comment_text").keydown(function(a){a.ctrlKey&&13==a.keyCode&&(a.preventDefault(),$("#btn_post_comment").click())});